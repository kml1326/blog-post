!function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("passport")},function(e,t,n){var o=n(0),s=n(14),i=new o.Schema({name:String,userName:String,email:String,password:String});i.methods.verifyPassword=function(e,t){s.compare(e,this.password,function(e,n){e&&t(e,!1),t(null,n)})},i.pre("save",function(e){var t=this.password,n=this;if(this.isModified(this.password))return e();s.genSalt(10,function(o,i){s.hash(t,i,function(t,o){n.password=o,e()})})});var r=o.model("User",i);e.exports=r},function(e,t,n){var o=n(0),s=(o.Schema.Types.ObjectId,new o.Schema({title:String,description:String,body:String,createdAt:Date})),i=o.model("Post",s);e.exports=i},function(e,t,n){var o=n(0),s=o.Schema.Types.ObjectId,i=new o.Schema({postId:{type:s,ref:"Post"},comment:String,createdAt:Date}),r=o.model("Comment",i);e.exports=r},function(e,t,n){(function(e){var t=n(1),o=n(7),s=t(),i=n(0),r=n(8)(o),u=n(9),d=n(2),c=n(10),a=n(11);i.connect("mongodb://localhost/blog-post",{useNewUrlParser:!0},function(e,t){if(e)throw e;console.log("connected to mongodb")}),s.use(u.json()),s.use(u.urlencoded({extended:!0})),s.use(t.static(a.join("dist"))),s.set("views",a.join(e,"./server/views")),s.set("view engine","ejs"),s.use(o({secret:"blog-post",resave:!0,saveUninitialized:!0,cookie:{maxAge:36e5},store:new r({url:"mongodb://localhost/blog-post-session"})})),s.use(d.initialize()),s.use(d.session()),n(12)(d),s.use(c()),s.use("/api",n(15)),s.use(n(19)),s.listen(8e3,function(){console.log("server is running on http://localhost:".concat(8e3))})}).call(this,"")},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("connect-mongo")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("path")},function(e,t,n){var o=n(13).Strategy,s=n(3);e.exports=function(e){e.serializeUser(function(e,t){t(null,e._id)}),e.deserializeUser(function(e,t){s.findById(e,function(e,n){t(e,n)})}),e.use(new o(function(e,t,n){s.findOne({userName:e},function(o,s){return console.log(e,s,"in passport"),o?n(o):s?void s.verifyPassword(t,function(e,t){return n(null,!!t&&s)}):n(null,!1)})}))}},function(e,t){e.exports=require("passport-local")},function(e,t){e.exports=require("bcrypt")},function(e,t,n){var o=n(1),s=n(16),i=n(17),r=n(18),u=o.Router();u.post("/signup",s.signup),u.post("/login",s.login),u.get("/isLoggedin",r.isLoggedIn,s.isLoggedIn),u.post("/create",i.create),u.put("/create",i.update),u.get("/posts",i.allPosts),u.get("/posts/:id",i.singlePost),u.post("/posts/:id/comment",i.createComment),u.get("/:id/comments",i.allComments),e.exports=u},function(e,t,n){var o=n(3),s=n(2);e.exports={signup:function(e,t){console.log(e.body,"req.body"),new o(e.body).save(function(e,n){if(e)throw e;return t.status(200).json({message:"signup successfull"})})},login:function(e,t,n){s.authenticate("local",function(o,s,i){return o?n(o):s?void e.logIn(s,function(o){return o?n(o):t.json({user:e.user})}):t.status(401).send({message:"Ple3ase Check User Name or Password"})})(e,t,n)},isLoggedIn:function(e,t){console.log(e.user,"req user for check user"),o.findOne({_id:e.user._id},{password:0},function(e,n){if(e)throw e;t.json({user:n})})}}},function(e,t,n){var o=n(4),s=n(5);e.exports={create:function(e,t){var n=e.body,s=n.title,i=n.description,r=n.body;new o({title:s,description:i,body:r,createdAt:new Date}).save(function(e,n){e?t.status(404):o.find({},function(e,n){e?t.status(404):t.json(n)})})},update:function(e,t){var n=e.body,s=n.title,i=n.description,r=n.body,u=n.id;o.findByIdAndUpdate(u,{title:s,description:i,body:r,createdAt:new Date},function(e,n){e?t.status(404):o.find({},function(e,n){e?t.status(404):t.json(n)})})},allPosts:function(e,t){o.find({},function(e,n){e?t.status(404):t.json(n)})},singlePost:function(e,t){o.findById(e.params.id,function(e,n){e?t.status(404):t.json(n)})},createComment:function(e,t){var n=e.body,o=n.id,i=n.comment;new s({postId:o,comment:i,createdAt:new Date}).save(function(e,n){e?t.status(404):s.find({postId:o},function(e,n){e?t.status(404):t.status(200).json(n)})})},allComments:function(e,t){var n=e.params.id;s.find({postId:n},function(e,n){e?t.status(404):t.status(200).json(n)})}}},function(e,t){e.exports={isLoggedIn:function(e,t,n){if(e.user)return n();t.status(400).send({message:"Please login to get your information."})}}},function(e,t,n){var o=n(1),s=n(5),i=n(4),r=o.Router();r.get("/",function(e,t){t.render("index")}),r.get("/signup",function(e,t){t.render("index")}),r.get("/dashboard",function(e,t){t.render("index")}),r.get("/logout",function(e,t){e.session.destroy(),t.status(200).redirect("/")}),r.get("/create",function(e,t){t.render("index")}),r.get("/posts/:id",function(e,t){t.render("index")}),r.delete("/posts/:id",function(e,t){i.findByIdAndRemove(e.params.id,function(n,o){console.log(o,"deleted Post data"),o&&s.remove({postId:e.params.id},function(e){if(e)throw e;i.find({},function(e,n){t.json(n)})})})}),r.delete("/comment/:id",function(e,t){console.log(e.params.id,e.headers,"comment Deleted"),s.findByIdAndRemove(e.params.id,function(n,o){console.log(o,"deleted data"),o&&s.find({postId:e.headers.postid},function(e,n){if(e)throw e;t.status(200).json(n)})})}),r.put("/comment/:id",function(e,t){console.log(e.params.id,e.headers,"comment edit"),s.findByIdAndUpdate(e.params.id,{comment:e.headers.comment,postId:e.headers.postid,createdAt:new Date},function(n,o){console.log(o,"update data"),o&&s.find({postId:e.headers.postid},function(e,n){if(e)throw e;t.status(200).json(n)})})}),r.get("*",function(e,t){t.send("<div><h1>Oop's Page Not Find</h1><img src='https://msegceporticoprodassets.blob.core.windows.net/asset-blobs/4095088_en_1'/></div>")}),e.exports=r}]);